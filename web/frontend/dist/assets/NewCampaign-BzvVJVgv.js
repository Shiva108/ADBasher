var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,n=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&i(e,a,t[a]);if(s)for(var a of s(t))l.call(t,a)&&i(e,a,t[a]);return e},d=(e,s)=>t(e,a(s));import{j as o}from"./index-Ca7tVjl2.js";import{u as c,r as m}from"./router-ld5oCHAN.js";import{a as x}from"./api-Do7PkaxD.js";import{A as p,b as h,a as u,S as b,c as v,d as f}from"./ui-jJASe3J9.js";import{s as g,a as j,d as N,b as y}from"./toast-C1yHlgyD.js";import"./react-vendor-BhyxaAfg.js";const w=e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"Domain cannot be empty"};const t=e.trim();if(t.length>253)return{valid:!1,error:"Domain name too long (max 253 characters)"};return/^(?:[a-zA-Z0-9_](?:[a-zA-Z0-9_-]{0,61}[a-zA-Z0-9_])?\.)*[a-zA-Z0-9_](?:[a-zA-Z0-9_-]{0,61}[a-zA-Z0-9_])?$/.test(t)?{valid:!0,error:""}:{valid:!1,error:"Invalid domain format"}},k=e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"IP address cannot be empty"};const t=e.trim();if(!/^(\d{1,3}\.){3}\d{1,3}$/.test(t))return{valid:!1,error:"Invalid IP address format"};const a=t.split(".");for(const s of a){const e=parseInt(s,10);if(e<0||e>255)return{valid:!1,error:"Invalid IP address range"}}return{valid:!0,error:""}},_=e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"Target cannot be empty"};const t=e.trim(),a=w(t);if(a.valid)return a;const s=k(t);if(s.valid)return s;const r=(e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"CIDR notation cannot be empty"};const t=e.trim();if(!/^(\d{1,3}\.){3}\d{1,3}\/\d{1,2}$/.test(t))return{valid:!1,error:"Invalid CIDR format (use IP/mask like 192.168.1.0/24)"};const[a,s]=t.split("/"),r=k(a);if(!r.valid)return r;const l=parseInt(s,10);return l<0||l>32?{valid:!1,error:"Invalid CIDR mask (must be 0-32)"}:{valid:!0,error:""}})(t);return r.valid?r:{valid:!1,error:"Must be a valid domain, IP address, or CIDR notation"}};function C(){const e=c(),[t,a]=m.useState(1),[s,r]=m.useState({}),[l,i]=m.useState({name:"",domain:"",targets:"",username:"",password:"",attack_profile:"balanced",enable_post_exploit:!0,enable_lateral_movement:!1,notification_email:""}),k=(e,t)=>{i(d(n({},l),{[e]:t})),s[e]&&r(d(n({},s),{[e]:void 0}))},C=()=>1===t?l.name&&l.domain:2!==t||l.targets.trim().length>0;return o.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("div",{className:"flex items-center justify-between",children:[1,2,3,4].map(e=>o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-semibold "+(e<=t?"bg-emerald-600 text-white":"bg-slate-700 text-slate-400"),children:e}),e<4&&o.jsx("div",{className:"w-24 h-1 "+(e<t?"bg-emerald-600":"bg-slate-700")})]},e))}),o.jsxs("div",{className:"flex justify-between mt-2",children:[o.jsx("span",{className:"text-xs text-slate-400",children:"Details"}),o.jsx("span",{className:"text-xs text-slate-400",children:"Targets"}),o.jsx("span",{className:"text-xs text-slate-400",children:"Settings"}),o.jsx("span",{className:"text-xs text-slate-400",children:"Review"})]})]}),o.jsx("div",{className:"bg-slate-800 rounded-lg p-8 border border-slate-700",children:(()=>{switch(t){case 1:return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[o.jsx(f,{className:"h-8 w-8 text-emerald-500"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"Campaign Details"}),o.jsx("p",{className:"text-slate-400",children:"Basic information about this assessment"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Campaign Name *"}),o.jsx("input",{type:"text",value:l.name,onChange:e=>k("name",e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:border-emerald-500",placeholder:"Q4 2024 Security Assessment"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Domain Name *"}),o.jsx("input",{type:"text",value:l.domain,onChange:e=>k("domain",e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:border-emerald-500",placeholder:"victim.local"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notification Email (Optional)"}),o.jsx("input",{type:"email",value:l.notification_email,onChange:e=>k("notification_email",e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:border-emerald-500",placeholder:"pentester@company.com"}),o.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Receive alerts when critical findings are discovered"})]})]});case 2:return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[o.jsx(v,{className:"h-8 w-8 text-emerald-500"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"Target Configuration"}),o.jsx("p",{className:"text-slate-400",children:"Define attack targets and credentials"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Target IP Addresses / CIDR Ranges *"}),o.jsx("textarea",{value:l.targets,onChange:e=>k("targets",e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:border-emerald-500 font-mono text-sm",rows:6,placeholder:"192.168.1.10\n10.0.0.0/24\ndc01.victim.local"}),o.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"One target per line. Supports IPs, CIDR notation, and hostnames."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Username (Optional)"}),o.jsx("input",{type:"text",value:l.username,onChange:e=>k("username",e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:border-emerald-500",placeholder:"Domain\\\\User"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Password (Optional)"}),o.jsx("input",{type:"password",value:l.password,onChange:e=>k("password",e.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-md text-white focus:outline-none focus:border-emerald-500",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})]}),o.jsx("div",{className:"bg-blue-900/20 border border-blue-700 rounded-md p-4",children:o.jsxs("p",{className:"text-sm text-blue-300",children:["ðŸ’¡ ",o.jsx("strong",{children:"Tip:"})," Credentials are optional. ADBasher will attempt to discover and compromise credentials automatically."]})})]});case 3:return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[o.jsx(b,{className:"h-8 w-8 text-emerald-500"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"Attack Configuration"}),o.jsx("p",{className:"text-slate-400",children:"Select attack modules and OpSec profile"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-3",children:"Attack Profile"}),o.jsx("div",{className:"grid grid-cols-3 gap-4",children:["stealth","balanced","aggressive"].map(e=>o.jsx("button",{onClick:()=>k("attack_profile",e),className:"p-4 rounded-lg border-2 transition-all "+(l.attack_profile===e?"border-emerald-500 bg-emerald-900/20":"border-slate-700 bg-slate-800 hover:border-slate-600"),children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-semibold text-white capitalize mb-1",children:e}),o.jsxs("div",{className:"text-xs text-slate-400",children:["stealth"===e&&"Slow, randomized timing","balanced"===e&&"Recommended for most","aggressive"===e&&"Fast, more detectable"]})]})},e))})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Attack Modules"}),o.jsxs("label",{className:"flex items-center space-x-3 p-4 bg-slate-800 rounded-lg border border-slate-700 cursor-pointer hover:border-slate-600",children:[o.jsx("input",{type:"checkbox",checked:l.enable_post_exploit,onChange:e=>k("enable_post_exploit",e.target.checked),className:"w-5 h-5 text-emerald-600 rounded focus:ring-emerald-500"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-white font-medium",children:"Post-Exploitation"}),o.jsx("div",{className:"text-sm text-slate-400",children:"BloodHound, secretsdump, LSASS dumping (requires credentials)"})]})]}),o.jsxs("label",{className:"flex items-center space-x-3 p-4 bg-slate-800 rounded-lg border border-slate-700 cursor-pointer hover:border-slate-600",children:[o.jsx("input",{type:"checkbox",checked:l.enable_lateral_movement,onChange:e=>k("enable_lateral_movement",e.target.checked),className:"w-5 h-5 text-emerald-600 rounded focus:ring-emerald-500"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-white font-medium",children:"Lateral Movement"}),o.jsx("div",{className:"text-sm text-slate-400",children:"PSExec, WMIExec, SMBExec across network (requires admin)"})]})]}),o.jsx("div",{className:"bg-amber-900/20 border border-amber-700 rounded-md p-4",children:o.jsxs("p",{className:"text-sm text-amber-300",children:["âš ï¸ ",o.jsx("strong",{children:"Note:"})," Persistence modules are disabled by default. They can be manually enabled from the dashboard after careful review."]})})]})]});case 4:return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[o.jsx(u,{className:"h-8 w-8 text-emerald-500"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"Review & Launch"}),o.jsx("p",{className:"text-slate-400",children:"Confirm settings and start campaign"})]})]}),o.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-6 space-y-4",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-slate-400",children:"Campaign Name"}),o.jsx("div",{className:"text-lg text-white font-medium",children:l.name||"Untitled Campaign"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-slate-400",children:"Domain"}),o.jsx("div",{className:"text-white",children:l.domain||"Not specified"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-slate-400",children:"Attack Profile"}),o.jsx("div",{className:"text-white capitalize",children:l.attack_profile})]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-slate-400 mb-1",children:"Targets"}),o.jsx("div",{className:"bg-slate-900 rounded p-3 font-mono text-sm text-white max-h-32 overflow-y-auto",children:l.targets||"No targets specified"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-slate-400 mb-2",children:"Enabled Modules"}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx("span",{className:"px-3 py-1 bg-emerald-900/30 text-emerald-400 rounded-full text-sm border border-emerald-700",children:"Reconnaissance"}),o.jsx("span",{className:"px-3 py-1 bg-emerald-900/30 text-emerald-400 rounded-full text-sm border border-emerald-700",children:"Credential Attacks"}),l.enable_post_exploit&&o.jsx("span",{className:"px-3 py-1 bg-emerald-900/30 text-emerald-400 rounded-full text-sm border border-emerald-700",children:"Post-Exploitation"}),l.enable_lateral_movement&&o.jsx("span",{className:"px-3 py-1 bg-emerald-900/30 text-emerald-400 rounded-full text-sm border border-emerald-700",children:"Lateral Movement"})]})]})]}),o.jsx("div",{className:"bg-red-900/20 border border-red-700 rounded-md p-4",children:o.jsxs("p",{className:"text-sm text-red-300",children:["ðŸš¨ ",o.jsx("strong",{children:"Warning:"})," This will launch an active penetration test. Ensure you have proper authorization before proceeding."]})})]});default:return null}})()}),o.jsxs("div",{className:"flex justify-between mt-6",children:[o.jsxs("button",{onClick:()=>a(t-1),disabled:1===t,className:"flex items-center space-x-2 px-6 py-3 bg-slate-700 text-white rounded-md hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx(p,{className:"h-4 w-4"}),o.jsx("span",{children:"Back"})]}),t<4?o.jsxs("button",{onClick:()=>a(t+1),disabled:!C(),className:"flex items-center space-x-2 px-6 py-3 bg-emerald-600 text-white rounded-md hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o.jsx("span",{children:"Next"}),o.jsx(h,{className:"h-4 w-4"})]}):o.jsx("button",{onClick:()=>{return t=null,a=null,s=function*(){var t,a;try{const t=l.targets.split("\n").map(e=>e.trim()).filter(e=>e.length>0),a=d(n({},l),{targets:t}),s=(e=>{const t={},a=(e=>{if(!e||"string"!=typeof e)return{valid:!1,error:"Campaign name cannot be empty"};const t=e.trim();return t.length<3?{valid:!1,error:"Campaign name must be at least 3 characters"}:t.length>100?{valid:!1,error:"Campaign name too long (max 100 characters)"}:/^[a-zA-Z0-9_ -]+$/.test(t)?{valid:!0,error:""}:{valid:!1,error:"Campaign name contains invalid characters"}})(e.name);a.valid||(t.name=a.error);const s=w(e.domain);if(s.valid||(t.domain=s.error),e.targets&&e.targets.trim()){const a=e.targets.split("\n").filter(e=>e.trim());for(let e=0;e<a.length;e++){const s=_(a[e]);if(!s.valid){t.targets=`Line ${e+1}: ${s.error}`;break}}}else t.targets="At least one target is required";if(e.notification_email){const a=(e=>{if(!e)return{valid:!0,error:""};if("string"!=typeof e)return{valid:!1,error:"Invalid email format"};const t=e.trim();return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)?{valid:!0,error:""}:{valid:!1,error:"Invalid email address format"}})(e.notification_email);a.valid||(t.notification_email=a.error)}return{valid:0===Object.keys(t).length,errors:t}})(l);if(!s.valid){r(s.errors);const e=Object.values(s.errors)[0];return void g(e)}const i=j("Creating campaign..."),o=yield x.post("/campaigns",a);N(i);const c=o.campaign_id;y("Campaign created successfully!"),e(`/campaign/${c}`)}catch(s){g("Failed to create campaign: "+((null==(a=null==(t=s.response)?void 0:t.data)?void 0:a.error)||s.message))}},new Promise((e,r)=>{var l=e=>{try{n(s.next(e))}catch(t){r(t)}},i=e=>{try{n(s.throw(e))}catch(t){r(t)}},n=t=>t.done?e(t.value):Promise.resolve(t.value).then(l,i);n((s=s.apply(t,a)).next())});var t,a,s},disabled:!C(),className:"flex items-center space-x-2 px-8 py-3 bg-emerald-600 text-white rounded-md hover:bg-emerald-700 font-semibold transition-colors text-lg disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsx("span",{children:"ðŸš€ Launch Campaign"})})]})]})}export{C as default};
